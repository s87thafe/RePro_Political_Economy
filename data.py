import pandas as pd
import plotly.express as px

# Data for the plot, derived from https://www.wahlrecht.de/umfragen/forsa/2007.htm
data = {
    "Date": ["26.12.2007", "19.12.2007", "12.12.2007", "05.12.2007", "28.11.2007", "21.11.2007", 
             "14.11.2007", "07.11.2007", "29.10.2007", "24.10.2007", "17.10.2007", "10.10.2007",
             "03.10.2007", "26.09.2007", "19.09.2007", "12.09.2007", "05.09.2007", "29.08.2007",
             "22.08.2007", "15.08.2007", "08.08.2007", "01.08.2007", "25.07.2007", "18.07.2007",
             "11.07.2007", "04.07.2007", "23.06.2007", "20.06.2007", "13.06.2007", "05.06.2007",
             "30.05.2007", "23.05.2007", "15.05.2007", "09.05.2007", "30.04.2007", "25.04.2007",
             "18.04.2007", "11.04.2007", "03.04.2007", "28.03.2007", "21.03.2007", "14.03.2007",
             "07.03.2007", "28.02.2007", "21.02.2007", "14.02.2007", "06.02.2007", "31.01.2007",
             "24.01.2007", "17.01.2007", "10.01.2007", "03.01.2007"],
    "CDU/CSU": [38, 38, 39, 39, 39, 40, 39, 40, 39, 39, 40, 39, 39, 39, 40, 40, 38, 38, 37, 38, 
                36, 38, 38, 38, 39, 37, 39, 37, 38, 36, 36, 38, 37, 37, 37, 34, 37, 36, 35, 35,
                35, 34, 35, 33, 34, 35, 34, 33, 34, 33, 35, 32],
    "SPD": [26, 26, 26, 27, 26, 24, 26, 26, 26, 26, 25, 24, 25, 26, 25, 25, 26, 26, 26, 24, 25,
            25, 25, 24, 24, 24, 24, 25, 27, 27, 26, 27, 28, 26, 26, 27, 26, 26, 28, 26, 27, 26,
            26, 29, 26, 26, 28, 27, 27, 28, 26, 27],
    "GRÜNE": [10, 10, 9, 9, 8, 9, 8, 10, 10, 9, 10, 9, 10, 10, 9, 10, 10, 10, 9, 10, 9, 10, 10, 
              10, 10, 10, 10, 10, 11, 11, 11, 10, 10, 10, 10, 11, 10, 11, 10, 12, 11, 11, 12, 11, 
              12, 11, 11, 10, 11, 11, 10, 11],
    "FDP": [10, 10, 10, 10, 10, 9, 10, 8, 9, 10, 9, 9, 9, 9, 8, 8, 9, 9, 11, 10, 11, 9, 9, 10, 
            9, 10, 10, 10, 8, 9, 10, 10, 11, 12, 11, 11, 12, 11, 11, 12, 11, 12, 12, 12, 12, 11, 
            12, 14, 14, 14, 13, 14],
    "LINKE": [11, 11, 11, 10, 12, 12, 12, 11, 11, 11, 11, 13, 12, 11, 12, 11, 12, 12, 12, 13, 
              13, 13, 13, 13, 13, 14, 13, 12, 11, 12, 12, 10, 9, 10, 11, 11, 10, 10, 10, 9, 10, 
              10, 10, 9, 10, 9, 9, 9, 8, 9, 10, 10],
    "Sonstige": [5, 5, 5, 5, 5, 6, 5, 5, 5, 5, 5, 6, 5, 5, 6, 6, 5, 5, 5, 5, 6, 5, 5, 5, 5, 5,
                 4, 6, 5, 5, 5, 5, 5, 5, 5, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6],
    "Befragte": [2501, 2503, 2501, 2500, 2500, 2501, 2503, 2502, 2503, 2502, 2502, 2002, 2501, 
                 2502, 2501, 2501, 2500, 2501, 2500, 2502, 2502, 2501, 2501, 2501, 2501, 2503, 
                 2501, 2501, 2501, 2002, 2503, 2002, 2501, 2001, 2503, 2500, 2004, 2004, 2505, 
                 2508, 2498, 2509, 2502, 2502, 2504, 2507, 2501, 2501, 2503, 2501, 2507, 2007]
}

df = pd.DataFrame(data)

# Convert "Date" column to datetime
df['Date'] = pd.to_datetime(df['Date'], dayfirst=True)

# Create the plot
fig = px.line(df, x='Date', y=['CDU/CSU', 'SPD', 'GRÜNE', 'FDP', 'LINKE', 'Sonstige'], 
              labels={'value': 'Percentage', 'variable': 'Party'}, title='Political Party Polls Over Time',
              color_discrete_map={'CDU/CSU': 'black', 'SPD': 'red', 'GRÜNE': 'green', 'FDP': 'yellow', 'LINKE': 'purple', 'Sonstige': 'grey'})

# Add a vertical red line at 20th April
fig.add_vline(x='2007-04-20', line=dict(color='red', width=2))

# Show the plot
fig.write_image("political_party_polls.png")